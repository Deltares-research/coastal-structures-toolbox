import pytest

import deltares_coastal_structures_toolbox.functions.structural.forces_caisson.goda1985 as caisson


# @pytest.mark.parametrize(
#     ("T, h, g, L_expected"),
#     (
#         ([2.0, 0.2, 9.8, 2.71]),  # values from goda (2000) tables
#         ([2.0, 1.0, 9.8, 5.21]),
#         ([2.0, 2.0, 9.8, 6.05]),
#         ([2.0, 11.0, 9.8, 6.24]),
#         ([5.0, 6.0, 9.8, 32.17]),
#     ),
# )
# def test_L_backward(T, h, g, L_expected):

#     L_calculated = caisson.calculate_local_wavelength(T=T, h=h, g=g)

#     assert L_calculated == pytest.approx(L_expected, abs=1e-2)


@pytest.mark.parametrize(
    (
        "HD, Hsi, Tmax, beta, h_s, d, B1, cota_seabed, rho_water, hacc, Rc, Bup, rho_fill_above_SWL, rho_fill_below_SWL, offshore_wave_steepness, muf, tup_over_Bup, FH_expected, FU_expected, MH_expected, MU_expected, p1_expected, pe_expected, pu_expected, SF_sliding_expected, SF_overturning_expected"
    ),
    (
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.9100000,
                3.1300000,
                10.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0738771,
                0.6000000,
                0.5000000,
                635.3200000,
                256.1300000,
                3208.0000000,
                1707.5180000,
                68.8019000,
                389.3290000,
                51.2260000,
                1.4674000,
                2.2887000,
            ]
        ),
        (
            [
                8.2300000,
                4.5500000,
                8.0000000,
                0.0000000,
                10.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0705219,
                0.6000000,
                0.5000000,
                1301.5000000,
                269.7300000,
                6880.0000000,
                1798.2260000,
                137.6400000,
                4257.1100000,
                53.9470000,
                0.7100500,
                1.0540000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                3.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                768.1700000,
                219.0600000,
                3919.6000000,
                1460.3920000,
                85.2254000,
                459.7850000,
                43.8120000,
                1.2426000,
                1.9362000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                20.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.0700000,
                2.7500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                100.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                466.2200000,
                191.4900000,
                2332.6000000,
                1276.5930000,
                52.9407000,
                320.9510000,
                38.2980000,
                2.0828000,
                3.3324000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1000.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                560.1700000,
                213.7200000,
                2858.3000000,
                1424.7730000,
                62.1493000,
                357.4420000,
                42.7430000,
                1.7255000,
                2.6934000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                8.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                674.3400000,
                202.6700000,
                4179.6000000,
                1351.1210000,
                63.7030000,
                481.8710000,
                40.5340000,
                1.6178000,
                2.0943000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                20.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                624.3100000,
                219.0600000,
                3543.1000000,
                1460.3920000,
                63.7030000,
                746.7410000,
                43.8120000,
                4.9230000,
                7.1258000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                5.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                109.5300000,
                2929.8000000,
                365.0980000,
                63.7030000,
                -408.5640000,
                43.8120000,
                0.8312100,
                0.6476000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2700.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                373.2590000,
                43.8120000,
                1.8162000,
                2.8415000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                1900.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                355.3990000,
                43.8120000,
                1.5394000,
                2.3895000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.3000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                0.8312100,
                2.5904000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.7500000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                85.2894000,
                43.8120000,
                1.6624000,
                4.1349000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                30.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                556.8900000,
                215.3300000,
                2835.0000000,
                1435.5110000,
                61.9555000,
                354.7040000,
                43.0650000,
                1.7181000,
                2.6858000,
            ]
        ),
        # ([5.07, 2.75, 12.0, 0.0, 5.0, 4.0, 100, 6.0, 5.0, 10.0, 2, 1025, 525.38]),
        # ([7.88, 4.35, 8.0, 0.0, 10.0, 4.0, 100, 6.0, 5.0, 10.0, 2, 1025, 1177.2]),  # C2
        # ([5.8, 3.05, 8.0, 0.0, 5.0, 4.0, 50, 6.0, 5.0, 10.0, 2, 1025, 574.18]),  # C1
    ),
)
def test_FH_backward(
    HD,
    Hsi,
    Tmax,
    beta,
    h_s,
    d,
    B1,
    cota_seabed,
    rho_water,
    hacc,
    Rc,
    Bup,
    rho_fill_above_SWL,
    rho_fill_below_SWL,
    offshore_wave_steepness,
    muf,
    tup_over_Bup,
    FH_expected,
    FU_expected,
    MH_expected,
    MU_expected,
    p1_expected,
    pe_expected,
    pu_expected,
    SF_sliding_expected,
    SF_overturning_expected,
):

    output = caisson.calculate_forces_and_reactions(
        HD=HD,
        Hsi=Hsi,
        Tmax=Tmax,
        beta=beta,
        h_s=h_s,
        d=d,
        cota_seabed=cota_seabed,
        hacc=hacc,
        Rc=Rc,
        Bup=Bup,
        B1=B1,
        rho_water=rho_water,
        g=9.81,
        return_dict=True,
        rho_fill_above_SWL=rho_fill_above_SWL,
        rho_fill_below_SWL=rho_fill_below_SWL,
        offshore_wave_steepness=offshore_wave_steepness,
        muf=muf,
        tup_over_Bup=tup_over_Bup,
    )

    if isinstance(output, dict):
        FH_calculated = output["FH"]
    else:
        FH_calculated = output[0]

    tol = 0.1 / 100 * FH_expected
    assert FH_calculated / 1000 == pytest.approx(FH_expected, abs=tol)


@pytest.mark.parametrize(
    (
        "HD, Hsi, Tmax, beta, h_s, d, B1, cota_seabed, rho_water, hacc, Rc, Bup, rho_fill_above_SWL, rho_fill_below_SWL, offshore_wave_steepness, muf, tup_over_Bup, FH_expected, FU_expected, MH_expected, MU_expected, p1_expected, pe_expected, pu_expected, SF_sliding_expected, SF_overturning_expected"
    ),
    (
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.9100000,
                3.1300000,
                10.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0738771,
                0.6000000,
                0.5000000,
                635.3200000,
                256.1300000,
                3208.0000000,
                1707.5180000,
                68.8019000,
                389.3290000,
                51.2260000,
                1.4674000,
                2.2887000,
            ]
        ),
        (
            [
                8.2300000,
                4.5500000,
                8.0000000,
                0.0000000,
                10.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0705219,
                0.6000000,
                0.5000000,
                1301.5000000,
                269.7300000,
                6880.0000000,
                1798.2260000,
                137.6400000,
                4257.1100000,
                53.9470000,
                0.7100500,
                1.0540000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                3.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                768.1700000,
                219.0600000,
                3919.6000000,
                1460.3920000,
                85.2254000,
                459.7850000,
                43.8120000,
                1.2426000,
                1.9362000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                20.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.0700000,
                2.7500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                100.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                466.2200000,
                191.4900000,
                2332.6000000,
                1276.5930000,
                52.9407000,
                320.9510000,
                38.2980000,
                2.0828000,
                3.3324000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1000.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                560.1700000,
                213.7200000,
                2858.3000000,
                1424.7730000,
                62.1493000,
                357.4420000,
                42.7430000,
                1.7255000,
                2.6934000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                8.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                674.3400000,
                202.6700000,
                4179.6000000,
                1351.1210000,
                63.7030000,
                481.8710000,
                40.5340000,
                1.6178000,
                2.0943000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                20.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                624.3100000,
                219.0600000,
                3543.1000000,
                1460.3920000,
                63.7030000,
                746.7410000,
                43.8120000,
                4.9230000,
                7.1258000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                5.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                109.5300000,
                2929.8000000,
                365.0980000,
                63.7030000,
                -408.5640000,
                43.8120000,
                0.8312100,
                0.6476000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2700.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                373.2590000,
                43.8120000,
                1.8162000,
                2.8415000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                1900.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                355.3990000,
                43.8120000,
                1.5394000,
                2.3895000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.3000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                0.8312100,
                2.5904000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.7500000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                85.2894000,
                43.8120000,
                1.6624000,
                4.1349000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                30.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                556.8900000,
                215.3300000,
                2835.0000000,
                1435.5110000,
                61.9555000,
                354.7040000,
                43.0650000,
                1.7181000,
                2.6858000,
            ]
        ),
        # ([5.07, 2.75, 12.0, 0.0, 5.0, 4.0, 100, 6.0, 5.0, 10.0, 2, 1025, 525.38]),
        # ([7.88, 4.35, 8.0, 0.0, 10.0, 4.0, 100, 6.0, 5.0, 10.0, 2, 1025, 1177.2]),  # C2
        # ([5.8, 3.05, 8.0, 0.0, 5.0, 4.0, 50, 6.0, 5.0, 10.0, 2, 1025, 574.18]),  # C1
    ),
)
def test_FU_backward(
    HD,
    Hsi,
    Tmax,
    beta,
    h_s,
    d,
    B1,
    cota_seabed,
    rho_water,
    hacc,
    Rc,
    Bup,
    rho_fill_above_SWL,
    rho_fill_below_SWL,
    offshore_wave_steepness,
    muf,
    tup_over_Bup,
    FH_expected,
    FU_expected,
    MH_expected,
    MU_expected,
    p1_expected,
    pe_expected,
    pu_expected,
    SF_sliding_expected,
    SF_overturning_expected,
):

    output = caisson.calculate_forces_and_reactions(
        HD=HD,
        Hsi=Hsi,
        Tmax=Tmax,
        beta=beta,
        h_s=h_s,
        d=d,
        cota_seabed=cota_seabed,
        hacc=hacc,
        Rc=Rc,
        Bup=Bup,
        B1=B1,
        rho_water=rho_water,
        g=9.81,
        return_dict=True,
        rho_fill_above_SWL=rho_fill_above_SWL,
        rho_fill_below_SWL=rho_fill_below_SWL,
        offshore_wave_steepness=offshore_wave_steepness,
        muf=muf,
        tup_over_Bup=tup_over_Bup,
    )

    if isinstance(output, dict):
        FU_calculated = output["FU"]
    else:
        FU_calculated = output[0]

    tol = 0.1 / 100 * FU_expected
    assert FU_calculated / 1000 == pytest.approx(FU_expected, abs=tol)


@pytest.mark.parametrize(
    (
        "HD, Hsi, Tmax, beta, h_s, d, B1, cota_seabed, rho_water, hacc, Rc, Bup, rho_fill_above_SWL, rho_fill_below_SWL, offshore_wave_steepness, muf, tup_over_Bup, FH_expected, FU_expected, MH_expected, MU_expected, p1_expected, pe_expected, pu_expected, SF_sliding_expected, SF_overturning_expected"
    ),
    (
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.9100000,
                3.1300000,
                10.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0738771,
                0.6000000,
                0.5000000,
                635.3200000,
                256.1300000,
                3208.0000000,
                1707.5180000,
                68.8019000,
                389.3290000,
                51.2260000,
                1.4674000,
                2.2887000,
            ]
        ),
        (
            [
                8.2300000,
                4.5500000,
                8.0000000,
                0.0000000,
                10.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0705219,
                0.6000000,
                0.5000000,
                1301.5000000,
                269.7300000,
                6880.0000000,
                1798.2260000,
                137.6400000,
                4257.1100000,
                53.9470000,
                0.7100500,
                1.0540000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                3.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                768.1700000,
                219.0600000,
                3919.6000000,
                1460.3920000,
                85.2254000,
                459.7850000,
                43.8120000,
                1.2426000,
                1.9362000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                20.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.0700000,
                2.7500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                100.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                466.2200000,
                191.4900000,
                2332.6000000,
                1276.5930000,
                52.9407000,
                320.9510000,
                38.2980000,
                2.0828000,
                3.3324000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1000.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                560.1700000,
                213.7200000,
                2858.3000000,
                1424.7730000,
                62.1493000,
                357.4420000,
                42.7430000,
                1.7255000,
                2.6934000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                8.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                674.3400000,
                202.6700000,
                4179.6000000,
                1351.1210000,
                63.7030000,
                481.8710000,
                40.5340000,
                1.6178000,
                2.0943000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                20.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                624.3100000,
                219.0600000,
                3543.1000000,
                1460.3920000,
                63.7030000,
                746.7410000,
                43.8120000,
                4.9230000,
                7.1258000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                5.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                109.5300000,
                2929.8000000,
                365.0980000,
                63.7030000,
                -408.5640000,
                43.8120000,
                0.8312100,
                0.6476000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2700.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                373.2590000,
                43.8120000,
                1.8162000,
                2.8415000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                1900.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                355.3990000,
                43.8120000,
                1.5394000,
                2.3895000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.3000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                0.8312100,
                2.5904000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.7500000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                85.2894000,
                43.8120000,
                1.6624000,
                4.1349000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                30.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                556.8900000,
                215.3300000,
                2835.0000000,
                1435.5110000,
                61.9555000,
                354.7040000,
                43.0650000,
                1.7181000,
                2.6858000,
            ]
        ),
    ),
)
def test_MH_backward(
    HD,
    Hsi,
    Tmax,
    beta,
    h_s,
    d,
    B1,
    cota_seabed,
    rho_water,
    hacc,
    Rc,
    Bup,
    rho_fill_above_SWL,
    rho_fill_below_SWL,
    offshore_wave_steepness,
    muf,
    tup_over_Bup,
    FH_expected,
    FU_expected,
    MH_expected,
    MU_expected,
    p1_expected,
    pe_expected,
    pu_expected,
    SF_sliding_expected,
    SF_overturning_expected,
):

    output = caisson.calculate_forces_and_reactions(
        HD=HD,
        Hsi=Hsi,
        Tmax=Tmax,
        beta=beta,
        h_s=h_s,
        d=d,
        cota_seabed=cota_seabed,
        hacc=hacc,
        Rc=Rc,
        Bup=Bup,
        B1=B1,
        rho_water=rho_water,
        g=9.81,
        return_dict=True,
        rho_fill_above_SWL=rho_fill_above_SWL,
        rho_fill_below_SWL=rho_fill_below_SWL,
        offshore_wave_steepness=offshore_wave_steepness,
        muf=muf,
        tup_over_Bup=tup_over_Bup,
    )

    if isinstance(output, dict):
        MH_calculated = output["MH"]
    else:
        MH_calculated = output[0]

    tol = 0.1 / 100 * MH_expected
    assert MH_calculated / 1000 == pytest.approx(MH_expected, abs=tol)


@pytest.mark.parametrize(
    (
        "HD, Hsi, Tmax, beta, h_s, d, B1, cota_seabed, rho_water, hacc, Rc, Bup, rho_fill_above_SWL, rho_fill_below_SWL, offshore_wave_steepness, muf, tup_over_Bup, FH_expected, FU_expected, MH_expected, MU_expected, p1_expected, pe_expected, pu_expected, SF_sliding_expected, SF_overturning_expected"
    ),
    (
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.9100000,
                3.1300000,
                10.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0738771,
                0.6000000,
                0.5000000,
                635.3200000,
                256.1300000,
                3208.0000000,
                1707.5180000,
                68.8019000,
                389.3290000,
                51.2260000,
                1.4674000,
                2.2887000,
            ]
        ),
        (
            [
                8.2300000,
                4.5500000,
                8.0000000,
                0.0000000,
                10.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0705219,
                0.6000000,
                0.5000000,
                1301.5000000,
                269.7300000,
                6880.0000000,
                1798.2260000,
                137.6400000,
                4257.1100000,
                53.9470000,
                0.7100500,
                1.0540000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                3.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                768.1700000,
                219.0600000,
                3919.6000000,
                1460.3920000,
                85.2254000,
                459.7850000,
                43.8120000,
                1.2426000,
                1.9362000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                20.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.0700000,
                2.7500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                100.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                466.2200000,
                191.4900000,
                2332.6000000,
                1276.5930000,
                52.9407000,
                320.9510000,
                38.2980000,
                2.0828000,
                3.3324000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1000.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                560.1700000,
                213.7200000,
                2858.3000000,
                1424.7730000,
                62.1493000,
                357.4420000,
                42.7430000,
                1.7255000,
                2.6934000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                8.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                674.3400000,
                202.6700000,
                4179.6000000,
                1351.1210000,
                63.7030000,
                481.8710000,
                40.5340000,
                1.6178000,
                2.0943000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                20.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                624.3100000,
                219.0600000,
                3543.1000000,
                1460.3920000,
                63.7030000,
                746.7410000,
                43.8120000,
                4.9230000,
                7.1258000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                5.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                109.5300000,
                2929.8000000,
                365.0980000,
                63.7030000,
                -408.5640000,
                43.8120000,
                0.8312100,
                0.6476000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2700.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                373.2590000,
                43.8120000,
                1.8162000,
                2.8415000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                1900.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                355.3990000,
                43.8120000,
                1.5394000,
                2.3895000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.3000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                0.8312100,
                2.5904000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.7500000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                85.2894000,
                43.8120000,
                1.6624000,
                4.1349000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                30.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                556.8900000,
                215.3300000,
                2835.0000000,
                1435.5110000,
                61.9555000,
                354.7040000,
                43.0650000,
                1.7181000,
                2.6858000,
            ]
        ),
    ),
)
def test_MU_backward(
    HD,
    Hsi,
    Tmax,
    beta,
    h_s,
    d,
    B1,
    cota_seabed,
    rho_water,
    hacc,
    Rc,
    Bup,
    rho_fill_above_SWL,
    rho_fill_below_SWL,
    offshore_wave_steepness,
    muf,
    tup_over_Bup,
    FH_expected,
    FU_expected,
    MH_expected,
    MU_expected,
    p1_expected,
    pe_expected,
    pu_expected,
    SF_sliding_expected,
    SF_overturning_expected,
):

    output = caisson.calculate_forces_and_reactions(
        HD=HD,
        Hsi=Hsi,
        Tmax=Tmax,
        beta=beta,
        h_s=h_s,
        d=d,
        cota_seabed=cota_seabed,
        hacc=hacc,
        Rc=Rc,
        Bup=Bup,
        B1=B1,
        rho_water=rho_water,
        g=9.81,
        return_dict=True,
        rho_fill_above_SWL=rho_fill_above_SWL,
        rho_fill_below_SWL=rho_fill_below_SWL,
        offshore_wave_steepness=offshore_wave_steepness,
        muf=muf,
        tup_over_Bup=tup_over_Bup,
    )

    if isinstance(output, dict):
        MU_calculated = output["MU"]
    else:
        MU_calculated = output[0]

    tol = 0.1 / 100 * MU_expected
    assert MU_calculated / 1000 == pytest.approx(MU_expected, abs=tol)


@pytest.mark.parametrize(
    (
        "HD, Hsi, Tmax, beta, h_s, d, B1, cota_seabed, rho_water, hacc, Rc, Bup, rho_fill_above_SWL, rho_fill_below_SWL, offshore_wave_steepness, muf, tup_over_Bup, FH_expected, FU_expected, MH_expected, MU_expected, p1_expected, pe_expected, pu_expected, SF_sliding_expected, SF_overturning_expected"
    ),
    (
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.9100000,
                3.1300000,
                10.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0738771,
                0.6000000,
                0.5000000,
                635.3200000,
                256.1300000,
                3208.0000000,
                1707.5180000,
                68.8019000,
                389.3290000,
                51.2260000,
                1.4674000,
                2.2887000,
            ]
        ),
        (
            [
                8.2300000,
                4.5500000,
                8.0000000,
                0.0000000,
                10.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0705219,
                0.6000000,
                0.5000000,
                1301.5000000,
                269.7300000,
                6880.0000000,
                1798.2260000,
                137.6400000,
                4257.1100000,
                53.9470000,
                0.7100500,
                1.0540000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                3.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                768.1700000,
                219.0600000,
                3919.6000000,
                1460.3920000,
                85.2254000,
                459.7850000,
                43.8120000,
                1.2426000,
                1.9362000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                20.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.0700000,
                2.7500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                100.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                466.2200000,
                191.4900000,
                2332.6000000,
                1276.5930000,
                52.9407000,
                320.9510000,
                38.2980000,
                2.0828000,
                3.3324000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1000.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                560.1700000,
                213.7200000,
                2858.3000000,
                1424.7730000,
                62.1493000,
                357.4420000,
                42.7430000,
                1.7255000,
                2.6934000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                8.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                674.3400000,
                202.6700000,
                4179.6000000,
                1351.1210000,
                63.7030000,
                481.8710000,
                40.5340000,
                1.6178000,
                2.0943000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                20.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                624.3100000,
                219.0600000,
                3543.1000000,
                1460.3920000,
                63.7030000,
                746.7410000,
                43.8120000,
                4.9230000,
                7.1258000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                5.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                109.5300000,
                2929.8000000,
                365.0980000,
                63.7030000,
                -408.5640000,
                43.8120000,
                0.8312100,
                0.6476000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2700.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                373.2590000,
                43.8120000,
                1.8162000,
                2.8415000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                1900.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                355.3990000,
                43.8120000,
                1.5394000,
                2.3895000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.3000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                0.8312100,
                2.5904000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.7500000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                85.2894000,
                43.8120000,
                1.6624000,
                4.1349000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                30.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                556.8900000,
                215.3300000,
                2835.0000000,
                1435.5110000,
                61.9555000,
                354.7040000,
                43.0650000,
                1.7181000,
                2.6858000,
            ]
        ),
    ),
)
def test_p1_backward(
    HD,
    Hsi,
    Tmax,
    beta,
    h_s,
    d,
    B1,
    cota_seabed,
    rho_water,
    hacc,
    Rc,
    Bup,
    rho_fill_above_SWL,
    rho_fill_below_SWL,
    offshore_wave_steepness,
    muf,
    tup_over_Bup,
    FH_expected,
    FU_expected,
    MH_expected,
    MU_expected,
    p1_expected,
    pe_expected,
    pu_expected,
    SF_sliding_expected,
    SF_overturning_expected,
):

    output = caisson.calculate_forces_and_reactions(
        HD=HD,
        Hsi=Hsi,
        Tmax=Tmax,
        beta=beta,
        h_s=h_s,
        d=d,
        cota_seabed=cota_seabed,
        hacc=hacc,
        Rc=Rc,
        Bup=Bup,
        B1=B1,
        rho_water=rho_water,
        g=9.81,
        return_dict=True,
        rho_fill_above_SWL=rho_fill_above_SWL,
        rho_fill_below_SWL=rho_fill_below_SWL,
        offshore_wave_steepness=offshore_wave_steepness,
        muf=muf,
        tup_over_Bup=tup_over_Bup,
    )

    if isinstance(output, dict):
        p1_calculated = output["p1"]
    else:
        p1_calculated = output[0]

    tol = 0.1 / 100 * p1_expected
    assert p1_calculated / 1000 == pytest.approx(p1_expected, abs=tol)


@pytest.mark.parametrize(
    (
        "HD, Hsi, Tmax, beta, h_s, d, B1, cota_seabed, rho_water, hacc, Rc, Bup, rho_fill_above_SWL, rho_fill_below_SWL, offshore_wave_steepness, muf, tup_over_Bup, FH_expected, FU_expected, MH_expected, MU_expected, p1_expected, pe_expected, pu_expected, SF_sliding_expected, SF_overturning_expected"
    ),
    (
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.9100000,
                3.1300000,
                10.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0738771,
                0.6000000,
                0.5000000,
                635.3200000,
                256.1300000,
                3208.0000000,
                1707.5180000,
                68.8019000,
                389.3290000,
                51.2260000,
                1.4674000,
                2.2887000,
            ]
        ),
        (
            [
                8.2300000,
                4.5500000,
                8.0000000,
                0.0000000,
                10.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0705219,
                0.6000000,
                0.5000000,
                1301.5000000,
                269.7300000,
                6880.0000000,
                1798.2260000,
                137.6400000,
                4277.728,  # changed based on xls sheet, compound errors due to single precision in VB6?
                53.9470000,
                0.7100500,
                1.0540000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                3.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                768.1700000,
                219.0600000,
                3919.6000000,
                1460.3920000,
                85.2254000,
                459.7850000,
                43.8120000,
                1.2426000,
                1.9362000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                20.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.0700000,
                2.7500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                100.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                466.2200000,
                191.4900000,
                2332.6000000,
                1276.5930000,
                52.9407000,
                320.9510000,
                38.2980000,
                2.0828000,
                3.3324000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1000.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                560.1700000,
                213.7200000,
                2858.3000000,
                1424.7730000,
                62.1493000,
                357.4420000,
                42.7430000,
                1.7255000,
                2.6934000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                8.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                674.3400000,
                202.6700000,
                4179.6000000,
                1351.1210000,
                63.7030000,
                481.8710000,
                40.5340000,
                1.6178000,
                2.0943000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                20.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                624.3100000,
                219.0600000,
                3543.1000000,
                1460.3920000,
                63.7030000,
                746.7410000,
                43.8120000,
                4.9230000,
                7.1258000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                5.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                109.5300000,
                2929.8000000,
                365.0980000,
                63.7030000,
                -408.5640000,
                43.8120000,
                0.8312100,
                0.6476000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2700.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                373.2590000,
                43.8120000,
                1.8162000,
                2.8415000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                1900.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                355.3990000,
                43.8120000,
                1.5394000,
                2.3895000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.3000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                0.8312100,
                2.5904000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.7500000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                85.2894000,
                43.8120000,
                1.6624000,
                4.1349000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                30.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                556.8900000,
                215.3300000,
                2835.0000000,
                1435.5110000,
                61.9555000,
                354.7040000,
                43.0650000,
                1.7181000,
                2.6858000,
            ]
        ),
    ),
)
def test_pe_backward(
    HD,
    Hsi,
    Tmax,
    beta,
    h_s,
    d,
    B1,
    cota_seabed,
    rho_water,
    hacc,
    Rc,
    Bup,
    rho_fill_above_SWL,
    rho_fill_below_SWL,
    offshore_wave_steepness,
    muf,
    tup_over_Bup,
    FH_expected,
    FU_expected,
    MH_expected,
    MU_expected,
    p1_expected,
    pe_expected,
    pu_expected,
    SF_sliding_expected,
    SF_overturning_expected,
):

    output = caisson.calculate_forces_and_reactions(
        HD=HD,
        Hsi=Hsi,
        Tmax=Tmax,
        beta=beta,
        h_s=h_s,
        d=d,
        cota_seabed=cota_seabed,
        hacc=hacc,
        Rc=Rc,
        Bup=Bup,
        B1=B1,
        rho_water=rho_water,
        g=9.81,
        return_dict=True,
        rho_fill_above_SWL=rho_fill_above_SWL,
        rho_fill_below_SWL=rho_fill_below_SWL,
        offshore_wave_steepness=offshore_wave_steepness,
        muf=muf,
        tup_over_Bup=tup_over_Bup,
    )

    if isinstance(output, dict):
        pe_calculated = output["pe"]
    else:
        pe_calculated = output[0]

    tol = abs(0.1 / 100 * pe_expected)
    assert pe_calculated / 1000 == pytest.approx(pe_expected, abs=tol)


@pytest.mark.parametrize(
    (
        "HD, Hsi, Tmax, beta, h_s, d, B1, cota_seabed, rho_water, hacc, Rc, Bup, rho_fill_above_SWL, rho_fill_below_SWL, offshore_wave_steepness, muf, tup_over_Bup, FH_expected, FU_expected, MH_expected, MU_expected, p1_expected, pe_expected, pu_expected, SF_sliding_expected, SF_overturning_expected"
    ),
    (
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.9100000,
                3.1300000,
                10.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0738771,
                0.6000000,
                0.5000000,
                635.3200000,
                256.1300000,
                3208.0000000,
                1707.5180000,
                68.8019000,
                389.3290000,
                51.2260000,
                1.4674000,
                2.2887000,
            ]
        ),
        (
            [
                8.2300000,
                4.5500000,
                8.0000000,
                0.0000000,
                10.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0705219,
                0.6000000,
                0.5000000,
                1301.5000000,
                269.7300000,
                6880.0000000,
                1798.2260000,
                137.6400000,
                4257.1100000,
                53.9470000,
                0.7100500,
                1.0540000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                3.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                768.1700000,
                219.0600000,
                3919.6000000,
                1460.3920000,
                85.2254000,
                459.7850000,
                43.8120000,
                1.2426000,
                1.9362000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                20.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.0700000,
                2.7500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                100.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                466.2200000,
                191.4900000,
                2332.6000000,
                1276.5930000,
                52.9407000,
                320.9510000,
                38.2980000,
                2.0828000,
                3.3324000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1000.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                560.1700000,
                213.7200000,
                2858.3000000,
                1424.7730000,
                62.1493000,
                357.4420000,
                42.7430000,
                1.7255000,
                2.6934000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                8.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                674.3400000,
                202.6700000,
                4179.6000000,
                1351.1210000,
                63.7030000,
                481.8710000,
                40.5340000,
                1.6178000,
                2.0943000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                20.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                624.3100000,
                219.0600000,
                3543.1000000,
                1460.3920000,
                63.7030000,
                746.7410000,
                43.8120000,
                4.9230000,
                7.1258000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                5.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                109.5300000,
                2929.8000000,
                365.0980000,
                63.7030000,
                -408.5640000,
                43.8120000,
                0.8312100,
                0.6476000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2700.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                373.2590000,
                43.8120000,
                1.8162000,
                2.8415000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                1900.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                355.3990000,
                43.8120000,
                1.5394000,
                2.3895000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.3000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                0.8312100,
                2.5904000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.7500000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                85.2894000,
                43.8120000,
                1.6624000,
                4.1349000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                30.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                556.8900000,
                215.3300000,
                2835.0000000,
                1435.5110000,
                61.9555000,
                354.7040000,
                43.0650000,
                1.7181000,
                2.6858000,
            ]
        ),
    ),
)
def test_pu_backward(
    HD,
    Hsi,
    Tmax,
    beta,
    h_s,
    d,
    B1,
    cota_seabed,
    rho_water,
    hacc,
    Rc,
    Bup,
    rho_fill_above_SWL,
    rho_fill_below_SWL,
    offshore_wave_steepness,
    muf,
    tup_over_Bup,
    FH_expected,
    FU_expected,
    MH_expected,
    MU_expected,
    p1_expected,
    pe_expected,
    pu_expected,
    SF_sliding_expected,
    SF_overturning_expected,
):

    output = caisson.calculate_forces_and_reactions(
        HD=HD,
        Hsi=Hsi,
        Tmax=Tmax,
        beta=beta,
        h_s=h_s,
        d=d,
        cota_seabed=cota_seabed,
        hacc=hacc,
        Rc=Rc,
        Bup=Bup,
        B1=B1,
        rho_water=rho_water,
        g=9.81,
        return_dict=True,
        rho_fill_above_SWL=rho_fill_above_SWL,
        rho_fill_below_SWL=rho_fill_below_SWL,
        offshore_wave_steepness=offshore_wave_steepness,
        muf=muf,
        tup_over_Bup=tup_over_Bup,
    )

    if isinstance(output, dict):
        pu_calculated = output["pu"]
    else:
        pu_calculated = output[0]

    tol = abs(0.1 / 100 * pu_expected)
    assert pu_calculated / 1000 == pytest.approx(pu_expected, abs=tol)


@pytest.mark.parametrize(
    (
        "HD, Hsi, Tmax, beta, h_s, d, B1, cota_seabed, rho_water, hacc, Rc, Bup, rho_fill_above_SWL, rho_fill_below_SWL, offshore_wave_steepness, muf, tup_over_Bup, FH_expected, FU_expected, MH_expected, MU_expected, p1_expected, pe_expected, pu_expected, SF_sliding_expected, SF_overturning_expected"
    ),
    (
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.9100000,
                3.1300000,
                10.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0738771,
                0.6000000,
                0.5000000,
                635.3200000,
                256.1300000,
                3208.0000000,
                1707.5180000,
                68.8019000,
                389.3290000,
                51.2260000,
                1.4674000,
                2.2887000,
            ]
        ),
        (
            [
                8.2300000,
                4.5500000,
                8.0000000,
                0.0000000,
                10.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0705219,
                0.6000000,
                0.5000000,
                1301.5000000,
                269.7300000,
                6880.0000000,
                1798.2260000,
                137.6400000,
                4257.1100000,
                53.9470000,
                0.7100500,
                1.0540000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                3.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                768.1700000,
                219.0600000,
                3919.6000000,
                1460.3920000,
                85.2254000,
                459.7850000,
                43.8120000,
                1.2426000,
                1.9362000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                20.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.0700000,
                2.7500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                100.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                466.2200000,
                191.4900000,
                2332.6000000,
                1276.5930000,
                52.9407000,
                320.9510000,
                38.2980000,
                2.0828000,
                3.3324000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1000.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                560.1700000,
                213.7200000,
                2858.3000000,
                1424.7730000,
                62.1493000,
                357.4420000,
                42.7430000,
                1.7255000,
                2.6934000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                8.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                674.3400000,
                202.6700000,
                4179.6000000,
                1351.1210000,
                63.7030000,
                481.8710000,
                40.5340000,
                1.6178000,
                2.0943000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                20.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                624.3100000,
                219.0600000,
                3543.1000000,
                1460.3920000,
                63.7030000,
                746.7410000,
                43.8120000,
                4.9230000,
                7.1258000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                5.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                109.5300000,
                2929.8000000,
                365.0980000,
                63.7030000,
                -408.5640000,
                43.8120000,
                0.8312100,
                0.6476000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2700.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                373.2590000,
                43.8120000,
                1.8162000,
                2.8415000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                1900.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                355.3990000,
                43.8120000,
                1.5394000,
                2.3895000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.3000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                0.8312100,
                2.5904000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.7500000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                85.2894000,
                43.8120000,
                1.6624000,
                4.1349000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                30.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                556.8900000,
                215.3300000,
                2835.0000000,
                1435.5110000,
                61.9555000,
                354.7040000,
                43.0650000,
                1.7181000,
                2.6858000,
            ]
        ),
    ),
)
def test_SFsliding_backward(
    HD,
    Hsi,
    Tmax,
    beta,
    h_s,
    d,
    B1,
    cota_seabed,
    rho_water,
    hacc,
    Rc,
    Bup,
    rho_fill_above_SWL,
    rho_fill_below_SWL,
    offshore_wave_steepness,
    muf,
    tup_over_Bup,
    FH_expected,
    FU_expected,
    MH_expected,
    MU_expected,
    p1_expected,
    pe_expected,
    pu_expected,
    SF_sliding_expected,
    SF_overturning_expected,
):

    output = caisson.calculate_forces_and_reactions(
        HD=HD,
        Hsi=Hsi,
        Tmax=Tmax,
        beta=beta,
        h_s=h_s,
        d=d,
        cota_seabed=cota_seabed,
        hacc=hacc,
        Rc=Rc,
        Bup=Bup,
        B1=B1,
        rho_water=rho_water,
        g=9.81,
        return_dict=True,
        rho_fill_above_SWL=rho_fill_above_SWL,
        rho_fill_below_SWL=rho_fill_below_SWL,
        offshore_wave_steepness=offshore_wave_steepness,
        muf=muf,
        tup_over_Bup=tup_over_Bup,
    )

    if isinstance(output, dict):
        SFS_calculated = output["SF_sliding"]
    else:
        SFS_calculated = output[0]

    tol = abs(0.1 / 100 * SF_sliding_expected)
    assert SFS_calculated == pytest.approx(SF_sliding_expected, abs=tol)


@pytest.mark.parametrize(
    (
        "HD, Hsi, Tmax, beta, h_s, d, B1, cota_seabed, rho_water, hacc, Rc, Bup, rho_fill_above_SWL, rho_fill_below_SWL, offshore_wave_steepness, muf, tup_over_Bup, FH_expected, FU_expected, MH_expected, MU_expected, p1_expected, pe_expected, pu_expected, SF_sliding_expected, SF_overturning_expected"
    ),
    (
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.9100000,
                3.1300000,
                10.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0738771,
                0.6000000,
                0.5000000,
                635.3200000,
                256.1300000,
                3208.0000000,
                1707.5180000,
                68.8019000,
                389.3290000,
                51.2260000,
                1.4674000,
                2.2887000,
            ]
        ),
        (
            [
                8.2300000,
                4.5500000,
                8.0000000,
                0.0000000,
                10.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0705219,
                0.6000000,
                0.5000000,
                1301.5000000,
                269.7300000,
                6880.0000000,
                1798.2260000,
                137.6400000,
                4257.1100000,
                53.9470000,
                0.7100500,
                1.0540000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                3.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                768.1700000,
                219.0600000,
                3919.6000000,
                1460.3920000,
                85.2254000,
                459.7850000,
                43.8120000,
                1.2426000,
                1.9362000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                20.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                1.6624000,
                2.5904000,
            ]
        ),
        (
            [
                5.0700000,
                2.7500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                100.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                466.2200000,
                191.4900000,
                2332.6000000,
                1276.5930000,
                52.9407000,
                320.9510000,
                38.2980000,
                2.0828000,
                3.3324000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1000.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                560.1700000,
                213.7200000,
                2858.3000000,
                1424.7730000,
                62.1493000,
                357.4420000,
                42.7430000,
                1.7255000,
                2.6934000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                8.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                674.3400000,
                202.6700000,
                4179.6000000,
                1351.1210000,
                63.7030000,
                481.8710000,
                40.5340000,
                1.6178000,
                2.0943000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                20.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                624.3100000,
                219.0600000,
                3543.1000000,
                1460.3920000,
                63.7030000,
                746.7410000,
                43.8120000,
                4.9230000,
                7.1258000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                5.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                109.5300000,
                2929.8000000,
                365.0980000,
                63.7030000,
                -408.5640000,
                43.8120000,
                0.8312100,
                0.6476000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2700.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                373.2590000,
                43.8120000,
                1.8162000,
                2.8415000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                1900.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                355.3990000,
                43.8120000,
                1.5394000,
                2.3895000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.3000000,
                0.5000000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                362.1120000,
                43.8120000,
                0.8312100,
                2.5904000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                0.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.7500000,
                574.1800000,
                219.0600000,
                2929.8000000,
                1460.3920000,
                63.7030000,
                85.2894000,
                43.8120000,
                1.6624000,
                4.1349000,
            ]
        ),
        (
            [
                5.8000000,
                3.0500000,
                8.0000000,
                30.0000000,
                5.0000000,
                4.0000000,
                2.0000000,
                50.0000000,
                1025.0000000,
                6.0000000,
                5.0000000,
                10.0000000,
                2400.0000000,
                2100.0000000,
                0.0941974,
                0.6000000,
                0.5000000,
                556.8900000,
                215.3300000,
                2835.0000000,
                1435.5110000,
                61.9555000,
                354.7040000,
                43.0650000,
                1.7181000,
                2.6858000,
            ]
        ),
    ),
)
def test_SFoverturning_backward(
    HD,
    Hsi,
    Tmax,
    beta,
    h_s,
    d,
    B1,
    cota_seabed,
    rho_water,
    hacc,
    Rc,
    Bup,
    rho_fill_above_SWL,
    rho_fill_below_SWL,
    offshore_wave_steepness,
    muf,
    tup_over_Bup,
    FH_expected,
    FU_expected,
    MH_expected,
    MU_expected,
    p1_expected,
    pe_expected,
    pu_expected,
    SF_sliding_expected,
    SF_overturning_expected,
):

    output = caisson.calculate_forces_and_reactions(
        HD=HD,
        Hsi=Hsi,
        Tmax=Tmax,
        beta=beta,
        h_s=h_s,
        d=d,
        cota_seabed=cota_seabed,
        hacc=hacc,
        Rc=Rc,
        Bup=Bup,
        B1=B1,
        rho_water=rho_water,
        g=9.81,
        return_dict=True,
        rho_fill_above_SWL=rho_fill_above_SWL,
        rho_fill_below_SWL=rho_fill_below_SWL,
        offshore_wave_steepness=offshore_wave_steepness,
        muf=muf,
        tup_over_Bup=tup_over_Bup,
    )

    if isinstance(output, dict):
        SFO_calculated = output["SF_overturning"]
    else:
        SFO_calculated = output[0]

    tol = abs(0.1 / 100 * SF_overturning_expected)
    assert SFO_calculated == pytest.approx(SF_overturning_expected, abs=tol)
